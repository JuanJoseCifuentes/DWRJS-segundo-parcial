{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useCallback, useEffect } from \"react\";\nimport { usePlatoDispatch } from \"../context/platoCtx\";\nimport { actions } from \"../context/platoReducer\";\nimport { usePlatoContext } from \"../context/platoCtx\";\nimport { useFilterContext } from \"../context/filtroCtx\";\nimport { FetchMealByFirstLetter, SearchMealByName } from \"../services/mealService\";\nconst usePlatos = () => {\n  _s();\n  const dispatch = usePlatoDispatch();\n  const {\n    filters\n  } = useFilterContext();\n  const {\n    metadata\n  } = usePlatoContext();\n  const fetchAllPlatos = async () => {\n    let allPlatos = [];\n    for (const letter in metadata.iniciales) {\n      allPlatos.push(FetchMealByFirstLetter(letter));\n    }\n    return allPlatos;\n  };\n  const fetchFilteredPlatos = async filter => {\n    let filteredPlatos = [];\n    filteredPlatos.push(SearchMealByName(filter));\n    return filteredPlatos;\n  };\n  const fetchPlatos = useCallback(async () => {\n    dispatch({\n      type: actions.SET_LOADING,\n      payload: true\n    });\n    try {\n      if (filters.search) {\n        const filteredPlatos = await fetchFilteredPlatos(filters.search);\n        if (filteredPlatos.length > 0) {\n          dispatch({\n            type: actions.SET_PLATOS,\n            payload: filteredPlatos\n          });\n        } else {\n          dispatch({\n            type: actions.SET_PLATOS,\n            payload: []\n          });\n        }\n      } else {\n        const allPlatos = await fetchAllPlatos();\n        console.log(allPlatos);\n        dispatch({\n          type: actions.SET_PLATOS,\n          payload: allPlatos\n        });\n      }\n    } catch (error) {\n      console.error(\"Error recuperando platos: \", error);\n      dispatch({\n        type: actions.SET_PLATOS,\n        payload: []\n      });\n    }\n    dispatch({\n      type: actions.SET_LOADING,\n      payload: false\n    });\n  }, [dispatch, filters, metadata]);\n  useEffect(() => {\n    fetchPlatos();\n  }, [fetchPlatos]);\n};\n_s(usePlatos, \"+PZtYIETcsoHWrtd4v6FpxxVKzA=\", false, function () {\n  return [usePlatoDispatch, useFilterContext, usePlatoContext];\n});\nexport default usePlatos;","map":{"version":3,"names":["useCallback","useEffect","usePlatoDispatch","actions","usePlatoContext","useFilterContext","FetchMealByFirstLetter","SearchMealByName","usePlatos","_s","dispatch","filters","metadata","fetchAllPlatos","allPlatos","letter","iniciales","push","fetchFilteredPlatos","filter","filteredPlatos","fetchPlatos","type","SET_LOADING","payload","search","length","SET_PLATOS","console","log","error"],"sources":["C:/Users/juanj/OneDrive/Documents/React/DWRJS-segundo-parcial/src/hooks/usePlato.js"],"sourcesContent":["import { useCallback, useEffect } from \"react\";\r\nimport { usePlatoDispatch } from \"../context/platoCtx\";\r\nimport { actions } from \"../context/platoReducer\";\r\nimport { usePlatoContext } from \"../context/platoCtx\";\r\nimport { useFilterContext } from \"../context/filtroCtx\";\r\n\r\nimport {\r\n  FetchMealByFirstLetter,\r\n  SearchMealByName,\r\n} from \"../services/mealService\";\r\n\r\nconst usePlatos = () => {\r\n  const dispatch = usePlatoDispatch();\r\n  const { filters } = useFilterContext();\r\n  const { metadata } = usePlatoContext();\r\n\r\n  const fetchAllPlatos = async () => {\r\n    let allPlatos = [];\r\n\r\n    for (const letter in metadata.iniciales) {\r\n      allPlatos.push(FetchMealByFirstLetter(letter));\r\n    }\r\n\r\n    return allPlatos;\r\n  };\r\n\r\n  const fetchFilteredPlatos = async (filter) => {\r\n    let filteredPlatos = [];\r\n\r\n    filteredPlatos.push(SearchMealByName(filter));\r\n\r\n    return filteredPlatos;\r\n  };\r\n\r\n  const fetchPlatos = useCallback(async () => {\r\n    dispatch({ type: actions.SET_LOADING, payload: true });\r\n    try {\r\n      if (filters.search) {\r\n        const filteredPlatos = await fetchFilteredPlatos(filters.search);\r\n\r\n        if (filteredPlatos.length > 0) {\r\n            dispatch({ type: actions.SET_PLATOS, payload: filteredPlatos });\r\n        } else {\r\n          dispatch({ type: actions.SET_PLATOS, payload: [] });\r\n        }\r\n      } else {\r\n        const allPlatos = await fetchAllPlatos();\r\n        console.log(allPlatos)\r\n        dispatch({ type: actions.SET_PLATOS, payload: allPlatos });\r\n      }\r\n    } catch(error) {\r\n        console.error(\"Error recuperando platos: \", error);\r\n        dispatch({ type: actions.SET_PLATOS, payload: [] });\r\n    }\r\n\r\n    dispatch({ type: actions.SET_LOADING, payload: false})\r\n  }, [dispatch, filters, metadata]);\r\n\r\n  useEffect (() => {\r\n    fetchPlatos();\r\n  }, [fetchPlatos]);\r\n};\r\n\r\nexport default usePlatos;\r\n"],"mappings":";AAAA,SAASA,WAAW,EAAEC,SAAS,QAAQ,OAAO;AAC9C,SAASC,gBAAgB,QAAQ,qBAAqB;AACtD,SAASC,OAAO,QAAQ,yBAAyB;AACjD,SAASC,eAAe,QAAQ,qBAAqB;AACrD,SAASC,gBAAgB,QAAQ,sBAAsB;AAEvD,SACEC,sBAAsB,EACtBC,gBAAgB,QACX,yBAAyB;AAEhC,MAAMC,SAAS,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACtB,MAAMC,QAAQ,GAAGR,gBAAgB,CAAC,CAAC;EACnC,MAAM;IAAES;EAAQ,CAAC,GAAGN,gBAAgB,CAAC,CAAC;EACtC,MAAM;IAAEO;EAAS,CAAC,GAAGR,eAAe,CAAC,CAAC;EAEtC,MAAMS,cAAc,GAAG,MAAAA,CAAA,KAAY;IACjC,IAAIC,SAAS,GAAG,EAAE;IAElB,KAAK,MAAMC,MAAM,IAAIH,QAAQ,CAACI,SAAS,EAAE;MACvCF,SAAS,CAACG,IAAI,CAACX,sBAAsB,CAACS,MAAM,CAAC,CAAC;IAChD;IAEA,OAAOD,SAAS;EAClB,CAAC;EAED,MAAMI,mBAAmB,GAAG,MAAOC,MAAM,IAAK;IAC5C,IAAIC,cAAc,GAAG,EAAE;IAEvBA,cAAc,CAACH,IAAI,CAACV,gBAAgB,CAACY,MAAM,CAAC,CAAC;IAE7C,OAAOC,cAAc;EACvB,CAAC;EAED,MAAMC,WAAW,GAAGrB,WAAW,CAAC,YAAY;IAC1CU,QAAQ,CAAC;MAAEY,IAAI,EAAEnB,OAAO,CAACoB,WAAW;MAAEC,OAAO,EAAE;IAAK,CAAC,CAAC;IACtD,IAAI;MACF,IAAIb,OAAO,CAACc,MAAM,EAAE;QAClB,MAAML,cAAc,GAAG,MAAMF,mBAAmB,CAACP,OAAO,CAACc,MAAM,CAAC;QAEhE,IAAIL,cAAc,CAACM,MAAM,GAAG,CAAC,EAAE;UAC3BhB,QAAQ,CAAC;YAAEY,IAAI,EAAEnB,OAAO,CAACwB,UAAU;YAAEH,OAAO,EAAEJ;UAAe,CAAC,CAAC;QACnE,CAAC,MAAM;UACLV,QAAQ,CAAC;YAAEY,IAAI,EAAEnB,OAAO,CAACwB,UAAU;YAAEH,OAAO,EAAE;UAAG,CAAC,CAAC;QACrD;MACF,CAAC,MAAM;QACL,MAAMV,SAAS,GAAG,MAAMD,cAAc,CAAC,CAAC;QACxCe,OAAO,CAACC,GAAG,CAACf,SAAS,CAAC;QACtBJ,QAAQ,CAAC;UAAEY,IAAI,EAAEnB,OAAO,CAACwB,UAAU;UAAEH,OAAO,EAAEV;QAAU,CAAC,CAAC;MAC5D;IACF,CAAC,CAAC,OAAMgB,KAAK,EAAE;MACXF,OAAO,CAACE,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MAClDpB,QAAQ,CAAC;QAAEY,IAAI,EAAEnB,OAAO,CAACwB,UAAU;QAAEH,OAAO,EAAE;MAAG,CAAC,CAAC;IACvD;IAEAd,QAAQ,CAAC;MAAEY,IAAI,EAAEnB,OAAO,CAACoB,WAAW;MAAEC,OAAO,EAAE;IAAK,CAAC,CAAC;EACxD,CAAC,EAAE,CAACd,QAAQ,EAAEC,OAAO,EAAEC,QAAQ,CAAC,CAAC;EAEjCX,SAAS,CAAE,MAAM;IACfoB,WAAW,CAAC,CAAC;EACf,CAAC,EAAE,CAACA,WAAW,CAAC,CAAC;AACnB,CAAC;AAACZ,EAAA,CAlDID,SAAS;EAAA,QACIN,gBAAgB,EACbG,gBAAgB,EACfD,eAAe;AAAA;AAiDtC,eAAeI,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}