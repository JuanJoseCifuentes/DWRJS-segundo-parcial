{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useCallback, useEffect } from \"react\";\nimport { usePlatoDispatch } from \"../context/platoCtx\";\nimport { actions } from \"../context/platoReducer\";\nimport { usePlatoContext } from \"../context/platoCtx\";\nimport { useFilterContext } from \"../context/filtroCtx\";\nimport { FetchMealByFirstLetter, SearchMealByName } from \"../services/mealService\";\nconst usePlatos = () => {\n  _s();\n  const dispatch = usePlatoDispatch();\n  const {\n    filters\n  } = useFilterContext();\n  const {\n    metadata\n  } = usePlatoContext();\n  const fetchAllPlatos = async () => {\n    let allPlatos = [];\n    for (const index in metadata.iniciales) {\n      allPlatos.push(await FetchMealByFirstLetter(metadata.iniciales[index]));\n    }\n    return allPlatos;\n  };\n  const fetchFilteredPlatos = async filter => {\n    let filteredPlatos = [];\n    filteredPlatos.push(await SearchMealByName(filter));\n    return filteredPlatos;\n  };\n  const fetchPlatos = useCallback(async () => {\n    dispatch({\n      type: actions.SET_LOADING,\n      payload: true\n    });\n    try {\n      if (filters.search) {\n        const filteredPlatos = await fetchFilteredPlatos(filters.search);\n        const platosResponse = [];\n        for (let i = 0; i < filteredPlatos.length; i++) {\n          if (filteredPlatos[i] != null) {\n            platosResponse.push(filteredPlatos[i]);\n          }\n        }\n        if (filteredPlatos.length > 0) {\n          dispatch({\n            type: actions.SET_PLATOS,\n            payload: filteredPlatos\n          });\n        } else {\n          dispatch({\n            type: actions.SET_PLATOS,\n            payload: []\n          });\n        }\n      } else {\n        const allPlatos = await fetchAllPlatos();\n        const platosResponse = [];\n        for (let i = 0; i < allPlatos.length; i++) {\n          if (allPlatos[i] != null) {\n            for (let j = 0; j < allPlatos[i].length; j++) {\n              platosResponse.push(allPlatos[i][j]);\n            }\n          }\n        }\n        dispatch({\n          type: actions.SET_PLATOS,\n          payload: platosResponse\n        });\n      }\n    } catch (error) {\n      console.error(\"Error recuperando platos: \", error);\n      dispatch({\n        type: actions.SET_PLATOS,\n        payload: []\n      });\n    }\n    dispatch({\n      type: actions.SET_LOADING,\n      payload: false\n    });\n  }, [dispatch, filters, metadata]);\n  useEffect(() => {\n    fetchPlatos();\n  }, [fetchPlatos]);\n};\n_s(usePlatos, \"+PZtYIETcsoHWrtd4v6FpxxVKzA=\", false, function () {\n  return [usePlatoDispatch, useFilterContext, usePlatoContext];\n});\nexport default usePlatos;","map":{"version":3,"names":["useCallback","useEffect","usePlatoDispatch","actions","usePlatoContext","useFilterContext","FetchMealByFirstLetter","SearchMealByName","usePlatos","_s","dispatch","filters","metadata","fetchAllPlatos","allPlatos","index","iniciales","push","fetchFilteredPlatos","filter","filteredPlatos","fetchPlatos","type","SET_LOADING","payload","search","platosResponse","i","length","SET_PLATOS","j","error","console"],"sources":["C:/Users/juanj/OneDrive/Documents/React/DWRJS-segundo-parcial/src/hooks/usePlato.js"],"sourcesContent":["import { useCallback, useEffect } from \"react\";\r\nimport { usePlatoDispatch } from \"../context/platoCtx\";\r\nimport { actions } from \"../context/platoReducer\";\r\nimport { usePlatoContext } from \"../context/platoCtx\";\r\nimport { useFilterContext } from \"../context/filtroCtx\";\r\n\r\nimport {\r\n  FetchMealByFirstLetter,\r\n  SearchMealByName,\r\n} from \"../services/mealService\";\r\n\r\nconst usePlatos = () => {\r\n  const dispatch = usePlatoDispatch();\r\n  const { filters } = useFilterContext();\r\n  const { metadata } = usePlatoContext();\r\n\r\n  const fetchAllPlatos = async () => {\r\n    let allPlatos = [];\r\n\r\n    for (const index in metadata.iniciales) {\r\n      allPlatos.push(await FetchMealByFirstLetter(metadata.iniciales[index]));\r\n    }\r\n\r\n    return allPlatos;\r\n  };\r\n\r\n  const fetchFilteredPlatos = async (filter) => {\r\n    let filteredPlatos = [];\r\n\r\n    filteredPlatos.push(await SearchMealByName(filter));\r\n\r\n    return filteredPlatos;\r\n  };\r\n\r\n  const fetchPlatos = useCallback(async () => {\r\n    dispatch({ type: actions.SET_LOADING, payload: true });\r\n    try {\r\n      if (filters.search) {\r\n        const filteredPlatos = await fetchFilteredPlatos(filters.search);\r\n        const platosResponse = [];\r\n        for (let i = 0; i < filteredPlatos.length; i++) {\r\n          if (filteredPlatos[i] != null) {\r\n              platosResponse.push(filteredPlatos[i]);\r\n          }\r\n        }\r\n\r\n        if (filteredPlatos.length > 0) {\r\n          dispatch({ type: actions.SET_PLATOS, payload: filteredPlatos });\r\n        } else {\r\n          dispatch({ type: actions.SET_PLATOS, payload: [] });\r\n        }\r\n      } else {\r\n        const allPlatos = await fetchAllPlatos();\r\n        const platosResponse = [];\r\n        for (let i = 0; i < allPlatos.length; i++) {\r\n          if (allPlatos[i] != null) {\r\n            for (let j = 0; j < allPlatos[i].length; j++) {\r\n              platosResponse.push(allPlatos[i][j]);\r\n            }\r\n          }\r\n        }\r\n\r\n        dispatch({ type: actions.SET_PLATOS, payload: platosResponse });\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error recuperando platos: \", error);\r\n      dispatch({ type: actions.SET_PLATOS, payload: [] });\r\n    }\r\n\r\n    dispatch({ type: actions.SET_LOADING, payload: false });\r\n  }, [dispatch, filters, metadata]);\r\n\r\n  useEffect(() => {\r\n    fetchPlatos();\r\n  }, [fetchPlatos]);\r\n};\r\n\r\nexport default usePlatos;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}